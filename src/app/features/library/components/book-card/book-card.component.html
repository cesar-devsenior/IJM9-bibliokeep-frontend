<article class="group overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm">
  <div class="flex gap-4 p-4">
    <div class="h-28 w-20 shrink-0 overflow-hidden rounded-xl bg-slate-100">
      @if (book().thumbnail) {
        <img
          class="h-full w-full object-cover transition-transform duration-200 group-hover:scale-105"
          [src]="book().thumbnail"
          [alt]="book().title"
          loading="lazy"
        />
      } @else {
        <div class="grid h-full w-full place-items-center text-xs font-medium text-slate-500">Sin portada</div>
      }
    </div>

    <div class="min-w-0 flex-1">
      <h3 class="truncate text-sm font-semibold text-slate-900">{{ book().title }}</h3>
      <p class="mt-1 line-clamp-2 text-xs text-slate-600">
        {{ book().authors.length ? book().authors.join(', ') : 'Autor desconocido' }}
      </p>
      <p class="mt-2 text-[11px] text-slate-500">ISBN: {{ book().isbn }}</p>

      <div class="mt-3 flex flex-wrap items-center gap-2">
        <div class="flex items-center gap-1">
          @for (star of [1, 2, 3, 4, 5]; track star) {
            <button
              type="button"
              class="rounded-md px-2 py-1 text-xs font-semibold"
              [ngClass]="
                star <= book().rating
                  ? 'bg-slate-900 text-white'
                  : 'bg-slate-100 text-slate-700 hover:bg-slate-200'
              "
              (click)="setRating(star)"
              [attr.aria-label]="'Puntuar ' + star"
            >
              {{ star }}
            </button>
          }
        </div>

        <div class="ml-auto">
          <select
            class="rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-medium text-slate-700 shadow-sm focus:border-slate-300 focus:outline-none"
            [value]="book().status"
            (change)="onStatusSelect($any($event.target).value)"
            aria-label="Estado"
          >
            @for (s of statuses; track trackByValue($index, s)) {
              <option [value]="s.value" [selected]="s.value === book().status">{{ s.label }}</option>
            }
          </select>
        </div>
      </div>
    </div>
  </div>
</article>

